{% extends "base.html" %}

{% load staticfiles %}

{% load cache %}

{% block title %}
    {{ object.title }}
{% endblock %}

{% block sidebar_btn %}
<div class="sidebar-btn">
    <button id="offcanvasleft" class="btn btn-xs" type="button" data-toggle="offcanvasleft">side</button>
</div>
{% endblock %}

{% block content %}
<div class="content-side">

    <div class="row row-offcanvas row-offcanvas-left">

        <div class="col-xs-6 col-md-3 sidebar-offcanvas" id="sidebarLeft" role="navigation">
            <div id="sidebar-nav">
                
                <ul class="nav" id="modules">
                <li><h3>Модулі</h3></li>
                <li><div class="progress">
                  <div class="progress-bar" style="width: {{ lectures_completed }}%;"></div>
                </div></li>
                <li>{{ lectures_completed|floatformat:"0" }} %</li>
                {% if modules %}
                    <li>Curriculum</li>
                    <li>about course</li>
                    <li>about teacher</li>
                {% else %}


                {% for m in object.modules.all %}
                    <li>
                        <!--<a href="{% url 'student_course_detail_module' object.id m.id %}" data-id="{{ m.id }}" class="module">-->
                            <span>
                                Module
                                <span class="order">{{ m.order|add:1 }}</span>
                            </span>
                            <br />
                            {{ m.title }}
                        <!--</a>-->
                    </li>
                    {% for lec in m.lectures.all %}
                        <li><a href="{% url 'student_course_detail_module_lecture' object.id m.id lec.id %}?prev-lecture={{lecture.id}}" data-id="{{ lec.id }}" class="lecture">{{ lec.title }}</a></li>
                    {% endfor %}
                {% empty %}
                    <li>No modules yet.</li>
                {% endfor %}

                {% endif %}
                </ul>
            </div>
        </div> <!-- end div.col-md-3-->

        <div class="col-xs-12 col-md-9">
            <div class="">
                {% if module %}
                    <!--{% cache 300 module_contents module %}-->
                    {% for lec in module.lectures.all %}
                        <!--{% with item=content.content_object %}
                            {{ item.render }}
                        {% endwith %}-->
                        <p><a href="{% url 'lecture_detail' object.id module.id lec.id %}">{{ lec.title }}</a></p>
                    {% endfor %}
                    <!--{% endcache %}-->
                {% endif %}

                {% if lecture %}
                    {% if next_lecture %}
                        <a href="{% url 'student_course_detail_module_lecture' object.id module_id next_lecture.id %}?prev-lecture={{lecture.id}}" class="btn">next</a>
                    {% endif %}

                    {% if complete_course %}
                        <a href="{% url 'course_completed' %}?prev-lecture={{lecture.id}}&prev-module={{module_id}}&prev-course={{object.id}}">next</a>
                    {% endif %}

                    {% for content in lecture.contents.all %}
                        {% with item=content.content_object %}
                            {{ item.render }}
                        {% endwith %}
                    {% endfor %}
                {% endif %}

                {% if modules %}
                    {% for m in object.modules.all %}
                        <p>{{ m.title }}</p>
                        {% for lec in m.lectures.all %}
                            <p><a href="{% url 'student_course_detail_module_lecture' object.id m.id lec.id %}">{{ lec.title }}</a></p>
                        {% endfor %}
                    {% empty %}

                    {% endfor %}

                {% endif %}
            </div> <!-- end div.module-->
        </div> <!-- end div.col-md-9.section-white.courses-->
    </div> <!-- end div.row-->

</div> <!-- end div.content-->
{% endblock %}

{% block domready %}
$('#offcanvasleft').click(function() {
  $('.row-offcanvas-left').toggleClass('active');
});

//$('a.module').click(function(e) {
//    e.preventDefault();
//    var module_id = $(this).data('id');
//    console.log($(this).attr('href'));
//    console.log(module_id);
//    $.ajax({
//        type: 'GET',
//        url: $(this).attr('href'),
//        contentType: 'application/json; charset=utf-8',
//        dataType: 'json',
//        data: {'module_id': module_id},
//        success: function(data) {
//            console.log(data);
//        }
//    });
//});

//$('a.lecture').click(function(e) {
//    e.preventDefault();
//    var lecture_id = $(this).data('id');
//    console.log($(this).attr('href'));
//    console.log(lecture_id);
//    $.ajax({
//        type: 'GET',
//        url: $(this).attr('href'),
//        contentType: 'application/json; charset=utf-8',
//        dataType: 'json',
//        data: {'lecture_id': lecture_id},
//        success: function(data) {
//            console.log(data);
//        }
//    });
//});
{% endblock %}